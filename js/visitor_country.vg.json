{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Top 20 Countries Visting Malaysia",
    "fontSize": 25,
    "font": "Crimson Text",
    "anchor": "start",
    "fontWeight": "bold"
  },
  "padding": 0,
  "width": "container",
  "height": "550",
  "projection": {
    "type": "naturalEarth1",
    "scale": 300,
    "center": [0, 15]
  },
  "params": [
    {
      "name": "selectedYear",
      "value": "2024",
      "bind": {
        "input": "select",
        "options": ["2023", "2024"],
        "name": "Select Visitor Count by Year: "
      }
    }
  ],
  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/7_others/oceans.topojson",
        "format": { "type": "topojson", "feature": "oceans" }
      },
      "mark": { "type": "geoshape", "fill": "#cce7ff" }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/3_choropleth_map/js/ne_110m_admin_0_countries.topojson",
        "format": { "type": "topojson", "feature": "ne_110m_admin_0_countries" }
      },
      "mark": {
        "type": "geoshape",
        "fill": "#fefefe",
        "stroke": "#bbb",
        "strokeWidth": 0.8
      }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/2_symbol_map/js/WorldMapWithGraticules.topojson",
        "format": { "type": "topojson", "feature": "ne_110m_graticules_30" }
      },
      "mark": { "type": "geoshape", "fill": null, "stroke": "#ddd" }
    },
    {
      "data": { "url": "./data/country_info.csv", "format": { "type": "csv" } },
      "transform": [{ "filter": "datum.name === 'Malaysia'" }],
      "mark": {
        "type": "circle",
        "color": "black",
        "size": 300,
        "opacity": 1,
        "stroke": "#fff",
        "strokeWidth": 2
      },
      "encoding": {
        "longitude": { "field": "longitude", "type": "quantitative" },
        "latitude": { "field": "latitude", "type": "quantitative" },
        "tooltip": { "field": "name", "type": "nominal" }
      }
    },
    {
      "data": {
        "url": "./data/top_20_countries_arrivals.csv",
        "format": { "type": "csv" }
      },
      "transform": [
        {
          "lookup": "COUNTRY OF NATIONALITY",
          "from": {
            "data": {
              "url": "./data/country_info.csv",
              "format": { "type": "csv" }
            },
            "key": "name",
            "fields": ["latitude", "longitude"]
          }
        },
        { "calculate": "toNumber(datum[selectedYear])", "as": "visitors" },
        { "calculate": "toNumber(datum['% GROWTH'])", "as": "growth" }
      ],
      "mark": {
        "type": "circle",
        "opacity": 0.8,
        "stroke": "#555",
        "strokeWidth": 0.5
      },
      "encoding": {
        "longitude": { "field": "longitude", "type": "quantitative" },
        "latitude": { "field": "latitude", "type": "quantitative" },
        "size": {
          "field": "growth",
          "type": "quantitative",
          "scale": { "range": [100, 1000], "domain": [1, 100] },
          "legend": { "title": "Percentage Growth (%)", "orient": "top-left" }
        },
        "color": {
          "field": "visitors",
          "type": "quantitative",
          "scale": {
            "type": "threshold",
            "domain": [1000000, 5000000, 10000000, 15000000],
            "range": ["#fee5d9", "#fcae91", "#fb6a4a", "#de2d26", "#a50f15"]
          },
          "legend": {
            "orient": "bottom-left",
            "title": "Number of visitors (Millions)",
            "format": "~s"
          }
        },
        "tooltip": [
          {
            "field": "COUNTRY OF NATIONALITY",
            "type": "nominal",
            "title": "Origin Country"
          },
          {
            "field": "visitors",
            "type": "quantitative",
            "title": "Visitors Count",
            "format": ",d"
          },
          {
            "field": "growth",
            "type": "quantitative",
            "title": "% Growth (2023 to 2024)",
            "format": ",d"
          }
        ]
      }
    },
    {
      "data": {
        "values": [
          {
            "country": "China",
            "longitude": 60.0,
            "latitude": 35.0,
            "label": "China"
          }
        ]
      },
      "layer": [
        {
          "mark": {
            "type": "text",
            "text": "Tourists from China are",
            "fontSize": 12,
            "fontWeight": "bold",
            "color": "#222",
            "dx": 8,
            "dy": -8,
            "align": "left"
          },
          "encoding": {
            "longitude": { "field": "longitude", "type": "quantitative" },
            "latitude": { "field": "latitude", "type": "quantitative" }
          }
        },
        {
          "mark": {
            "type": "text",
            "text": "growing fast in recent years",
            "fontSize": 12,
            "fontWeight": "bold",
            "color": "#222",
            "dx": 8,
            "dy": 6,
            "align": "left"
          },
          "encoding": {
            "longitude": { "field": "longitude", "type": "quantitative" },
            "latitude": { "field": "latitude", "type": "quantitative" }
          }
        }
      ]
    },
    {
      "data": {
        "values": [
          {
            "country": "Singapore",
            "longitude": 65.8198,
            "latitude": 2.3521,
            "label": "Singapore"
          }
        ]
      },
      "layer": [
        {
          "mark": {
            "type": "text",
            "text": "Singapore has the most",
            "fontSize": 12,
            "fontWeight": "bold",
            "color": "#222",
            "dx": 8,
            "dy": -8,
            "align": "left"
          },
          "encoding": {
            "longitude": { "field": "longitude", "type": "quantitative" },
            "latitude": { "field": "latitude", "type": "quantitative" }
          }
        },
        {
          "mark": {
            "type": "text",
            "text": "traveler count to Malaysia",
            "fontSize": 12,
            "fontWeight": "bold",
            "color": "#222",
            "dx": 8,
            "dy": 6,
            "align": "left"
          },
          "encoding": {
            "longitude": { "field": "longitude", "type": "quantitative" },
            "latitude": { "field": "latitude", "type": "quantitative" }
          }
        }
      ]
    },
    {
      "data": {
        "values": [
          {
            "country": "France",
            "longitude": 2.2137,
            "latitude": 46.2276,
            "label": "France"
          }
        ]
      },
      "layer": [
        {
          "mark": {
            "type": "text",
            "text": "Visitors from France",
            "fontSize": 12,
            "fontWeight": "bold",
            "color": "#222",
            "dx": -30,
            "dy": 24,
            "align": "left"
          },
          "encoding": {
            "longitude": { "field": "longitude", "type": "quantitative" },
            "latitude": { "field": "latitude", "type": "quantitative" }
          }
        },
        {
          "mark": {
            "type": "text",
            "text": "shows the highest growth",
            "fontSize": 12,
            "fontWeight": "bold",
            "color": "#222",
            "dx": -30,
            "dy": 36,
            "align": "left"
          },
          "encoding": {
            "longitude": { "field": "longitude", "type": "quantitative" },
            "latitude": { "field": "latitude", "type": "quantitative" }
          }
        },
        {
          "mark": {
            "type": "text",
            "text": "among European countries",
            "fontSize": 12,
            "fontWeight": "bold",
            "color": "#222",
            "dx": -30,
            "dy": 48,
            "align": "left"
          },
          "encoding": {
            "longitude": { "field": "longitude", "type": "quantitative" },
            "latitude": { "field": "latitude", "type": "quantitative" }
          }
        }
      ]
    },
    {
      "data": {
        "values": [
          {
            "country": "United States",
            "longitude": -98.5795,
            "latitude": 39.8283,
            "label": "United States"
          }
        ]
      },
      "layer": [
        {
          "mark": {
            "type": "text",
            "text": "The United states has the highest",
            "fontSize": 12,
            "fontWeight": "bold",
            "color": "#222",
            "dx": 32,
            "dy": -8,
            "align": "left"
          },
          "encoding": {
            "longitude": { "field": "longitude", "type": "quantitative" },
            "latitude": { "field": "latitude", "type": "quantitative" }
          }
        },
        {
          "mark": {
            "type": "text",
            "text": "number of visitors from the Americas",
            "fontSize": 12,
            "fontWeight": "bold",
            "color": "#222",
            "dx": 32,
            "dy": 6,
            "align": "left"
          },
          "encoding": {
            "longitude": { "field": "longitude", "type": "quantitative" },
            "latitude": { "field": "latitude", "type": "quantitative" }
          }
        }
      ]
    }
  ]
}
